<!DOCTYPE html>
<html>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta content="TypeScript, types, type version" name="keywords">
    <meta
      content="Effective TypeScript 系列：使用 TypeScript 後要注意的版本管理、介紹 @types - Han"
      property="og:title"
    />
    <meta
      content="紀錄 han 的前端/生活/各種筆記與日常～！ - 本篇文章提到在 TypeScript 開發中需要注意的地方：包括套件版本控制、綑綁套件、以及介紹 @types。"
      property="og:description"
    />
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1">




<title>Effective TypeScript 系列：使用 TypeScript 後要注意的版本管理、介紹 @types | Han</title>
<link rel="canonical" href="http://localhost:1313/posts/typescript-types/">
<meta name="description" content="本篇文章提到在 TypeScript 開發中需要注意的地方：包括套件版本控制、綑綁套件、以及介紹 @types。" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Effective TypeScript 系列：使用 TypeScript 後要注意的版本管理、介紹 @types | Han" />
<meta property="og:url" content="http://localhost:1313/posts/typescript-types/" />
<meta property="og:description" content="本篇文章提到在 TypeScript 開發中需要注意的地方：包括套件版本控制、綑綁套件、以及介紹 @types。" />








<link rel="stylesheet" href="/lib/icofont/icofont.min.css" />
<link rel="stylesheet" href="/css/syntax.css" />
<link rel="stylesheet" href="/css/style.css" />
<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
 
  </head>

  <body>
    <header class="header-wrapper">
    <div class="header">
        <a class="site-title" href="http://localhost:1313/">Han</a>

        <nav class="menu">
            
                <div class="menu-item">
                    
                        <a href="/posts/">Posts</a>
                    
                </div>
            
                <div class="menu-item">
                    
                        <a href="/about/">About</a>
                    
                </div>
            
        </nav>
    </div>
</header>

    <main class="main-wrapper">
      <div class="main">

<section class="single">
    <h1 class="title">Effective TypeScript 系列：使用 TypeScript 後要注意的版本管理、介紹 @types</h1>

    
        <div class="tip">
            <time datetime="2024-04-06 14:05:08 &#43;0800 CST">2024/04/06</time>
            <span class="split">·</span>
            <span> 1462 words </span>
            <span class="split">·</span>
            <span>
                3 minutes to read
            </span>
        </div>
    

    <div class="taxonomies">
        
        <div>
            Categories:
            
                <a href="/categories/typescript">TypeScript</a>
            
        </div>
        

        
            <div>
                Tags:
                
                    <a href="/tags/effective-typescript">Effective TypeScript</a>
                
            </div>
        
    </div>

    <hr />

    <div class="content">
        <h3 id="動機">動機 <a href="#%e5%8b%95%e6%a9%9f" class="anchor">🔗</a></h3><p>和轉職班的同學在近期一起讀了 Effective TypeScript 這本書，讀到第六章：型態宣告與 <code>@types</code>，提到了使用 TypeScript 之後要注意的點、使用 TypeScript 後常見的 <code>@types</code> 從何而來、自己在寫型態宣告時需要注意的點，以及如何去測試型態宣告。</p>
<p>我覺得這個章節是個平常在開發時可能常見，但比較少去意識到的部分，所以將這些重點整理起來，也讓之後的自己更方便回顧～
本篇會先提及的部分是使用 TypeScript 之後要注意的點、使用 TypeScript 後常見的 <code>@types</code> 從何而來，避免啪拉啪拉讓文章拉的太長！接著也會持續把內容在下一篇補齊～</p>
<h3 id="這篇文會提到">這篇文會提到 <a href="#%e9%80%99%e7%af%87%e6%96%87%e6%9c%83%e6%8f%90%e5%88%b0" class="anchor">🔗</a></h3><ul>
<li><a href="#%E6%B1%BA%E5%AE%9A%E8%A6%81%E4%BD%BF%E7%94%A8-typescript-%E5%BE%8C%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E5%9C%B0%E6%96%B9%E8%AE%8A%E5%A4%9A%E4%BA%86">決定要使用 TypeScript 後，要注意的地方變多了</a></li>
<li><a href="#%E7%B6%91%E7%B6%81%E5%A5%97%E4%BB%B6%E8%88%87%E5%9E%8B%E6%85%8B%E5%AE%A3%E5%91%8A%E7%9A%84%E7%89%88%E6%9C%AC">綑綁套件與型態宣告的版本</a></li>
<li><a href="#%E4%B8%8A%E9%9D%A2%E5%B8%B8%E5%B8%B8%E6%8F%90%E5%88%B0%E7%9A%84-types-%E6%98%AF%E4%BB%80%E9%BA%BC%E5%91%A2">上面常常提到的 @types 是什麼呢？</a></li>
</ul>
<h3 id="決定要使用-typescript-後要注意的地方變多了">決定要使用 TypeScript 後，要注意的地方變多了 <a href="#%e6%b1%ba%e5%ae%9a%e8%a6%81%e4%bd%bf%e7%94%a8-typescript-%e5%be%8c%e8%a6%81%e6%b3%a8%e6%84%8f%e7%9a%84%e5%9c%b0%e6%96%b9%e8%ae%8a%e5%a4%9a%e4%ba%86" class="anchor">🔗</a></h3><h4 id="決定要使用-typescript-之後要在哪裡安裝-typescript-及-typescript-相關的套件呢">決定要使用 TypeScript 之後，要在哪裡安裝 TypeScript 及 TypeScript 相關的套件呢？ <a href="#%e6%b1%ba%e5%ae%9a%e8%a6%81%e4%bd%bf%e7%94%a8-typescript-%e4%b9%8b%e5%be%8c%e8%a6%81%e5%9c%a8%e5%93%aa%e8%a3%a1%e5%ae%89%e8%a3%9d-typescript-%e5%8f%8a-typescript-%e7%9b%b8%e9%97%9c%e7%9a%84%e5%a5%97%e4%bb%b6%e5%91%a2" class="anchor">🔗</a></h4><p>TypeScript 作為一種開發工具，且 type 在執行期並不存在，因此作者建議把 TypeScript 及 <code>@types</code> 相關的東西放在 devDependencies。</p>
<p>相較於 dependencies 主要是用在 production 環境，上線後如果沒有這個套件就會報錯、無法執行，devDependencies 主要用於開發、測試程式碼，上線後就不需要用到。</p>
<p>上述提到 TypeScript 主要是在開發時使用，type 在上線後也不存在，ts 相關的程式碼會被轉為 JavaScript 來執行，所以作者認為把 TypeScript 及 <code>@types</code> 相關的東西放在 devDependencies 會是比較合適的。</p>
<pre tabindex="0"><code>npm install --save-dev @types/react
</code></pre><h4 id="使用-typescript-需要注意三個依賴項目的版本">使用 TypeScript 需要注意三個依賴項目的版本 <a href="#%e4%bd%bf%e7%94%a8-typescript-%e9%9c%80%e8%a6%81%e6%b3%a8%e6%84%8f%e4%b8%89%e5%80%8b%e4%be%9d%e8%b3%b4%e9%a0%85%e7%9b%ae%e7%9a%84%e7%89%88%e6%9c%ac" class="anchor">🔗</a></h4><ol>
<li>TypeScript 的版本</li>
<li>套件的版本</li>
<li>套件 <code>@types</code> 的版本</li>
</ol>
<p>這三個版本需要注意什麼呢？</p>
<ul>
<li>套件與其對應的 <code>@types</code> 版本是否同步
不同步的情況下，不論是套件的版本比 <code>@types</code> 更新、或是 <code>@types</code> 的版本比套件更新，都可能導致 type 對應不上，導致 ts 報錯。</li>
<li>套件可能使用比專案更新的 TypeScript 版本</li>
</ul>
<ol>
<li>在這個狀況下，可以去更新 TypeScript 版本、使用舊的 <code>@types</code> 版本，如果前面這兩個方法你都不想或無法做到的話，在遇到型別錯誤的情況下，可以使用 declare module 手動宣告</li>
</ol>
<p>根據 ChatGPT，declare module 實作的方式為
如果你使用了一個名為 <code>foo</code> 的套件，且它的型態有問題，可以建立一個 <code>foo-extension.d.ts</code> 的檔案（.d.ts 前面是什麼都可以）</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// foo-extension.d.ts
</span></span></span><span class="line"><span class="cl"><span class="c1">// declare module &#39;套件名稱&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">declare</span> <span class="kr">module</span> <span class="nx">&#34;foo&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">export</span> <span class="kr">interface</span> <span class="nx">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">foo</span> <span class="kr">from</span> <span class="s2">&#34;foo-extension&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">person</span>: <span class="kt">foo.Person</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;John&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><ol start="2">
<li>為特定版本 ts 安裝 <code>@types</code> <code>npm install --save-dev @types/lodash@ts3.1</code></li>
</ol>
<h3 id="綑綁套件與型態宣告的版本">綑綁套件與型態宣告的版本 <a href="#%e7%b6%91%e7%b6%81%e5%a5%97%e4%bb%b6%e8%88%87%e5%9e%8b%e6%85%8b%e5%ae%a3%e5%91%8a%e7%9a%84%e7%89%88%e6%9c%ac" class="anchor">🔗</a></h3><p>有些套件會透過綑綁的方式，將套件本身和套件的型態宣告綁起來，確實可以解決套件和 type 版本不相符的問題。但同時也會遇到一些其他的問題</p>
<p>綑綁 types 會寫在 package.json 裡面，指向 <code>.d.ts</code> 檔案的 types 欄位</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;left-pad&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;version&#34;</span><span class="p">:</span> <span class="s2">&#34;1.3.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;String left pad&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;main&#34;</span><span class="p">:</span> <span class="s2">&#34;index.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;types&#34;</span><span class="p">:</span> <span class="s2">&#34;index.d.ts&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ol>
<li>可能無法透過 declare module 的方式進行擴增</li>
<li>可能發布的時候沒問題，但新版的 TypeScript 有問題 -&gt; 可能為了這個原因，只能使用舊版 ts</li>
<li>如果綑綁的型態依賴另一個套件的型態宣告（通常依賴的 <code>@types</code> 在它的 devDependencies 內），安裝這個套件 <code>npm install A</code> 時，A 套件依賴的 devDependencies 不會被下載，只會下載 A 套件的 dependencies <a href="https://juejin.cn/post/7077520444332441630" target="_blank">（什么包放在 devDependencies？什么包放在 dependencies？）</a>
，但如果將依賴的型態宣告安裝在 dependency 內，JavaScript 用戶也會安裝到，但 JavaScript 使用者其實是不需要 <code>@types</code> 套件的（畢竟他們沒有用 TypeScript）</li>
</ol>
<p>作者建議除非程式庫是用 TypeScript 寫的，否則不要綑綁型態宣告。</p>
<h3 id="上面常常提到的-types-是什麼呢">上面常常提到的 @types 是什麼呢？ <a href="#%e4%b8%8a%e9%9d%a2%e5%b8%b8%e5%b8%b8%e6%8f%90%e5%88%b0%e7%9a%84-types-%e6%98%af%e4%bb%80%e9%ba%bc%e5%91%a2" class="anchor">🔗</a></h3><p><code>@types</code> 是套件的開發者在維護的嗎？
<code>@types</code> 來自於 DefinitelyTyped：是由社群維護的 JavaScript 套件的型態定義集。
<a href="https://github.com/DefinitelyTyped/DefinitelyTyped" target="_blank">DefinitelyTyped Github</a>
</p>
<p>如果套件本身沒有 TypeScript 的型態宣告，通常比較熱門的套件都可以在 DefinitelyTyped 找到型態，例如使用 <code>lodash</code> 套件，可以安裝 <code>@types/lodash</code>。</p>
<pre tabindex="0"><code>npm install --save-dev @types/lodash
</code></pre><h3 id="總結">總結 <a href="#%e7%b8%bd%e7%b5%90" class="anchor">🔗</a></h3><ol>
<li>使用 TypeScript 時應該注意 TypeScript 本身的版本、套件以及相對應的 <code>@types</code> 的版本</li>
<li>綑綁套件與型態宣告的版本可能會遇到一些問題</li>
<li>使用 TypeScript 後經常搭配套件下載的 <code>@types</code> 為 DefinitelyTyped 社群維護</li>
</ol>
<h3 id="ref-參考">REF 參考 <a href="#ref-%e5%8f%83%e8%80%83" class="anchor">🔗</a></h3><ul>
<li><a href="https://www.books.com.tw/products/0010858053" target="_blank">Effective TypeScript 中文版</a>
</li>
<li><a href="https://juejin.cn/post/7077520444332441630" target="_blank">什么包放在 devDependencies？什么包放在 dependencies？</a>
</li>
<li><a href="https://github.com/DefinitelyTyped/DefinitelyTyped" target="_blank">DefinitelyTyped Github</a>
</li>
</ul>

    </div>

    

    <div class="disqus markdown" style="width: 100%;">
        <div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    
    

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'https-www-zzuhann-work';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
</section>

</div>
      <div class="side">
         <div class="side-recent">
    <h2 class="side-title">
        <a href="/posts/">Recent Posts</a>
    </h2>
    <hr />

    <ul>
        
            <li>
                <a href="/posts/ts-unknown-vs-any/">Effective TypeScript: unknown vs any</a>
            </li>
        
            <li>
                <a href="/posts/use-slug-for-dynamic-routes/">使用 Next.js 的 Dynamic Routes 來處理多層結構的頁面</a>
            </li>
        
            <li>
                <a href="/posts/use-flex-to-limit-font-size/">使用 flex box 來防止字體被動態調整？</a>
            </li>
        
            <li>
                <a href="/posts/strict-false-ignore-null-ts/">tsconfig 設定 strict: false 會忽略 null 的型別判定</a>
            </li>
        
            <li>
                <a href="/posts/brain-can-not-multiwork/">讀書日記 | 大腦沒辦法多工，即使訓練也一樣！</a>
            </li>
        
    </ul>
</div>
 
        <div class="side-categories">
    <h2>Categories</h2>
    <hr />

    <ul>
        
            <li>
                <a href="/categories/typescript">typescript(4)</a>
            </li>
        
            <li>
                <a href="/categories/%E5%89%8D%E7%AB%AF">前端(2)</a>
            </li>
        
            <li>
                <a href="/categories/%E6%8A%80%E8%A1%93">技術(7)</a>
            </li>
        
            <li>
                <a href="/categories/%E6%9D%82%E6%8A%80%E6%B5%85%E5%B0%9D">杂技浅尝(1)</a>
            </li>
        
            <li>
                <a href="/categories/%E8%A7%80%E7%9C%8B%E7%AD%86%E8%A8%98">觀看筆記(1)</a>
            </li>
        
            <li>
                <a href="/categories/%E8%AE%80%E6%9B%B8%E6%97%A5%E8%A8%98">讀書日記(2)</a>
            </li>
        
    </ul>
</div>
 <div class="side-tags">
    <h2>Tags</h2>
    <hr />

    <ul>
        
            <li>
                <a href="/tags/css">css (1)</a>
            </li>
        
            <li>
                <a href="/tags/css-challenge">css challenge (1)</a>
            </li>
        
            <li>
                <a href="/tags/effective-typescript">effective typescript (4)</a>
            </li>
        
            <li>
                <a href="/tags/hugo">hugo (3)</a>
            </li>
        
            <li>
                <a href="/tags/next.js">next.js (1)</a>
            </li>
        
            <li>
                <a href="/tags/reading-diary">reading diary (2)</a>
            </li>
        
            <li>
                <a href="/tags/typescript">typescript (2)</a>
            </li>
        
            <li>
                <a href="/tags/video-diary">video diary (1)</a>
            </li>
        
    </ul>
</div>

      </div>
    </main>
  </body>
</html>
