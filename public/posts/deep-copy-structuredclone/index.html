<!DOCTYPE html>
<html>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta content="deep copy, structuredClone" name="keywords">
    <meta
      content="ä½¿ç”¨ structuredClone() ä¾†é€²è¡Œæ·±æ‹·è² - Han"
      property="og:title"
    />
    <meta
      content="ç´€éŒ„ han çš„å‰ç«¯/ç”Ÿæ´»/å„ç¨®ç­†è¨˜èˆ‡æ—¥å¸¸ï½ï¼ - åœ¨å·¥ä½œä¸­ï¼Œæ·±æ‹·è²æ˜¯ä¸€é …å¸¸è¦‹çš„ä»»å‹™ï¼Œä»¥é¿å…å°åŸå§‹ç‰©ä»¶çš„å½±éŸ¿ã€‚å‚³çµ±çš„æ–¹æ³•æ˜¯ä½¿ç”¨JSON.parse(JSON.stringify(x))ï¼Œä½†å®ƒæœ‰ä¸€äº›é™åˆ¶ã€‚æœ€è¿‘ç™¼ç¾äº†structuredCloneå‡½æ•¸ï¼Œå®ƒå¯ä»¥å½Œè£œé€™äº›ç¼ºé»ï¼Œä¸¦ä¸”ä¸éœ€è¦é¡å¤–çš„å¥—ä»¶ã€‚é€™ç¯‡ç­†è¨˜ä»‹ç´¹äº†æ·±æ·ºæ‹·è²çš„å¸¸è¦‹æ–¹æ³•ï¼Œè©•ä¼°äº†structuredCloneçš„å„ªç¼ºé»ï¼Œä¸¦æä¾›äº†æ‰‹å¯«æ·±æ‹·è²çš„æ–¹æ³•ã€‚"
      property="og:description"
    />
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1">




<title>ä½¿ç”¨ structuredClone() ä¾†é€²è¡Œæ·±æ‹·è² | Han</title>
<link rel="canonical" href="http://localhost:1313/posts/deep-copy-structuredclone/">
<meta name="description" content="åœ¨å·¥ä½œä¸­ï¼Œæ·±æ‹·è²æ˜¯ä¸€é …å¸¸è¦‹çš„ä»»å‹™ï¼Œä»¥é¿å…å°åŸå§‹ç‰©ä»¶çš„å½±éŸ¿ã€‚å‚³çµ±çš„æ–¹æ³•æ˜¯ä½¿ç”¨JSON.parse(JSON.stringify(x))ï¼Œä½†å®ƒæœ‰ä¸€äº›é™åˆ¶ã€‚æœ€è¿‘ç™¼ç¾äº†structuredCloneå‡½æ•¸ï¼Œå®ƒå¯ä»¥å½Œè£œé€™äº›ç¼ºé»ï¼Œä¸¦ä¸”ä¸éœ€è¦é¡å¤–çš„å¥—ä»¶ã€‚é€™ç¯‡ç­†è¨˜ä»‹ç´¹äº†æ·±æ·ºæ‹·è²çš„å¸¸è¦‹æ–¹æ³•ï¼Œè©•ä¼°äº†structuredCloneçš„å„ªç¼ºé»ï¼Œä¸¦æä¾›äº†æ‰‹å¯«æ·±æ‹·è²çš„æ–¹æ³•ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:title" content="ä½¿ç”¨ structuredClone() ä¾†é€²è¡Œæ·±æ‹·è² | Han" />
<meta property="og:url" content="http://localhost:1313/posts/deep-copy-structuredclone/" />
<meta property="og:description" content="åœ¨å·¥ä½œä¸­ï¼Œæ·±æ‹·è²æ˜¯ä¸€é …å¸¸è¦‹çš„ä»»å‹™ï¼Œä»¥é¿å…å°åŸå§‹ç‰©ä»¶çš„å½±éŸ¿ã€‚å‚³çµ±çš„æ–¹æ³•æ˜¯ä½¿ç”¨JSON.parse(JSON.stringify(x))ï¼Œä½†å®ƒæœ‰ä¸€äº›é™åˆ¶ã€‚æœ€è¿‘ç™¼ç¾äº†structuredCloneå‡½æ•¸ï¼Œå®ƒå¯ä»¥å½Œè£œé€™äº›ç¼ºé»ï¼Œä¸¦ä¸”ä¸éœ€è¦é¡å¤–çš„å¥—ä»¶ã€‚é€™ç¯‡ç­†è¨˜ä»‹ç´¹äº†æ·±æ·ºæ‹·è²çš„å¸¸è¦‹æ–¹æ³•ï¼Œè©•ä¼°äº†structuredCloneçš„å„ªç¼ºé»ï¼Œä¸¦æä¾›äº†æ‰‹å¯«æ·±æ‹·è²çš„æ–¹æ³•ã€‚" />








<link rel="stylesheet" href="/lib/icofont/icofont.min.css" />
<link rel="stylesheet" href="/css/syntax.css" />
<link rel="stylesheet" href="/css/style.css" />
<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
 
  </head>

  <body>
    <header class="header-wrapper">
    <div class="header">
        <a class="site-title" href="http://localhost:1313/">Han</a>

        <nav class="menu">
            
                <div class="menu-item">
                    
                        <a href="/posts/">Posts</a>
                    
                </div>
            
                <div class="menu-item">
                    
                        <a href="/about/">About</a>
                    
                </div>
            
        </nav>
    </div>
</header>

    <main class="main-wrapper">
      <div class="main">

<section class="single">
    <h1 class="title">ä½¿ç”¨ structuredClone() ä¾†é€²è¡Œæ·±æ‹·è²</h1>

    
        <div class="tip">
            <time datetime="2024-02-14 14:29:05 &#43;0800 CST">2024/02/14</time>
            <span class="split">Â·</span>
            <span> 1825 words </span>
            <span class="split">Â·</span>
            <span>
                4 minutes to read
            </span>
        </div>
    

    <div class="taxonomies">
        
        <div>
            Categories:
            
                <a href="/categories/%E5%89%8D%E7%AB%AF">å‰ç«¯</a>
            
        </div>
        

        
    </div>

    <hr />

    <div class="content">
        <h3 id="å‹•æ©Ÿ">å‹•æ©Ÿ <a href="#%e5%8b%95%e6%a9%9f" class="anchor">ğŸ”—</a></h3><p>åœ¨å·¥ä½œä¸Šæœ‰æ™‚æœƒä½¿ç”¨åˆ°æ·±æ‹·è²ï¼Œé¿å…å½±éŸ¿åˆ°åŸæœ‰çš„ç‰©ä»¶ï¼Œèµ·åˆéƒ½æ˜¯ä½¿ç”¨ <code>JSON.parse(JSON.stringify(x))</code> çš„æ–¹å¼ä¾†åšæ·±æ‹·è²ï¼Œå› ç‚ºä¸ç”¨å†é¡å¤–å¼•å…¥å¥—ä»¶ã€ä¹Ÿæ˜¯æ¯”è¼ƒå¸¸è¦‹çš„åšæ³•ã€‚</p>
<p>æœ‰ä¸€æ¬¡çœ‹åˆ°åœ¨ä»‹ç´¹ <code>structuredClone</code> é€™å€‹ function çš„æ–‡ç« ï¼Œå¯ä»¥è§£æ±º <code>JSON.parse(JSON.stringify(x))</code> æœƒé‡åˆ°çš„ç¼ºé»ï¼ŒåŒæ¨£ä¹Ÿä¸ç”¨é¡å¤–å¼•å…¥å¥—ä»¶ï¼Œå°±èƒ½é”åˆ°æ·±æ‹·è²çš„éœ€æ±‚ã€‚å› ç‚ºæ˜¯ç¬¬ä¸€æ¬¡çœ‹åˆ° <code>structuredClone</code> é€™å€‹åšæ³•ï¼Œæ‰€ä»¥æƒ³åšæˆç­†è¨˜ï¼ŒåŒæ™‚ä»‹ç´¹å¸¸è¦‹çš„æ·±æ·ºæ‹·è²æ–¹å¼ã€ä½¿ç”¨ structuredClone çš„å„ªç¼ºé»ï¼Œä»¥åŠæœ€å¾Œå¦‚ä½•å¯¦ä½œæ‰‹å¯«æ·±æ‹·è²ã€‚</p>
<h3 id="é€™ç¯‡æ–‡æœƒæåˆ°">é€™ç¯‡æ–‡æœƒæåˆ° <a href="#%e9%80%99%e7%af%87%e6%96%87%e6%9c%83%e6%8f%90%e5%88%b0" class="anchor">ğŸ”—</a></h3><ul>
<li><a href="#%E7%B0%A1%E4%BB%8B%E6%B7%BA%E6%8B%B7%E8%B2%9D%E8%88%87%E6%B7%B1%E6%8B%B7%E8%B2%9D">ç°¡ä»‹æ·ºæ‹·è²èˆ‡æ·±æ‹·è²</a></li>
<li><a href="#%E5%B8%B8%E8%A6%8B%E7%9A%84%E6%B7%BA%E6%8B%B7%E8%B2%9D%E4%BD%9C%E6%B3%95">å¸¸è¦‹çš„æ·ºæ‹·è²ä½œæ³•</a></li>
<li><a href="#%E5%B8%B8%E8%A6%8B%E7%9A%84%E6%B7%B1%E6%8B%B7%E8%B2%9D%E4%BD%9C%E6%B3%95">å¸¸è¦‹çš„æ·±æ‹·è²ä½œæ³•</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8-structuredclone-%E4%BE%86%E9%80%B2%E8%A1%8C%E6%B7%B1%E6%8B%B7%E8%B2%9D">ä½¿ç”¨ structuredClone() ä¾†é€²è¡Œæ·±æ‹·è²</a></li>
<li><a href="#%E5%AF%A6%E4%BD%9C%E6%89%8B%E5%AF%AB%E6%B7%B1%E6%8B%B7%E8%B2%9D">å¯¦ä½œæ‰‹å¯«æ·±æ‹·è²</a></li>
</ul>
<h3 id="ç°¡ä»‹æ·ºæ‹·è²èˆ‡æ·±æ‹·è²">ç°¡ä»‹æ·ºæ‹·è²èˆ‡æ·±æ‹·è² <a href="#%e7%b0%a1%e4%bb%8b%e6%b7%ba%e6%8b%b7%e8%b2%9d%e8%88%87%e6%b7%b1%e6%8b%b7%e8%b2%9d" class="anchor">ğŸ”—</a></h3><ul>
<li><strong>æ·ºæ‹·è²</strong>ï¼šåœ¨æ‹·è²æ™‚ï¼Œåªé‡å°åŸå§‹å‹åˆ¥é€²è¡Œæ‹·è²ï¼Œå‰µå»ºæ–°çš„è¨˜æ†¶é«”ä½å€ï¼›ä½†å°æ–¼ç‰©ä»¶é¡ï¼ˆobject, array ç­‰ï¼‰ä¸æœƒå»ºç«‹æ–°çš„è¨˜æ†¶é«”ä½å€ï¼Œè€Œæ˜¯å…±åŒæŒ‡å‘ç›¸åŒçš„ä½å€ã€‚</li>
</ul>
<p>å¦‚æœ result é‡å° <code>result.array</code> åšäº† <code>push</code> çš„å‹•ä½œï¼Œæœƒè®“ <code>result.array</code> çš„é™£åˆ—å¤šä¸€å€‹ <code>4</code> å…ƒç´ ï¼Œä½†å› ç‚ºå’Œ <code>è¢«æ‹·è²å°è±¡.array</code> å…±ç”¨è¨˜æ†¶é«”ä½å€ï¼Œå¯¦éš›ä¸Šæ˜¯æ›´æ”¹åˆ°åŒä¸€å€‹ arrayã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">è¢«æ‹·è²å°è±¡</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">string</span><span class="o">:</span> <span class="s2">&#34;hi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">array</span><span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{</span> <span class="p">...</span><span class="nx">è¢«æ‹·è²å°è±¡</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">result</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">array</span><span class="p">);</span> <span class="c1">// [1, 2, 3, 4]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">è¢«æ‹·è²å°è±¡</span><span class="p">.</span><span class="nx">array</span><span class="p">);</span> <span class="c1">// [1, 2, 3, 4]
</span></span></span></code></pre></div><ul>
<li><strong>æ·±æ‹·è²</strong>ï¼šæ‹·è²å°è±¡èˆ‡è¢«æ‹·è²å°è±¡å„è‡ªæŒ‡å‘ä¸åŒçš„è¨˜æ†¶é«”ä½å€ã€‚</li>
</ul>
<h3 id="å¸¸è¦‹çš„æ·ºæ‹·è²ä½œæ³•">å¸¸è¦‹çš„æ·ºæ‹·è²ä½œæ³• <a href="#%e5%b8%b8%e8%a6%8b%e7%9a%84%e6%b7%ba%e6%8b%b7%e8%b2%9d%e4%bd%9c%e6%b3%95" class="anchor">ğŸ”—</a></h3><p>è¦é”åˆ°æ·ºæ‹·è²ï¼Œæœ‰ä»¥ä¸‹æ–¹å¼</p>
<ul>
<li>Object spread: <code>{ ...è¢«æ‹·è²å°è±¡ }</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">nestedArr</span><span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">string</span><span class="o">:</span> <span class="s2">&#34;hi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="p">{</span> <span class="p">...</span><span class="nx">a</span> <span class="p">};</span>
</span></span></code></pre></div><ul>
<li><code>Object.assign({}, è¢«æ·ºæ‹·è²çš„å°è±¡)</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">nestedArr</span><span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">string</span><span class="o">:</span> <span class="s2">&#34;hi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({},</span> <span class="nx">a</span><span class="p">);</span>
</span></span></code></pre></div><ul>
<li><code>Object.create(è¢«æ‹·è²å°è±¡)</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">nestedArr</span><span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">string</span><span class="o">:</span> <span class="s2">&#34;hi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
</span></span></code></pre></div><h3 id="å¸¸è¦‹çš„æ·±æ‹·è²ä½œæ³•">å¸¸è¦‹çš„æ·±æ‹·è²ä½œæ³• <a href="#%e5%b8%b8%e8%a6%8b%e7%9a%84%e6%b7%b1%e6%8b%b7%e8%b2%9d%e4%bd%9c%e6%b3%95" class="anchor">ğŸ”—</a></h3><p>è¦é”åˆ°æ·±æ‹·è²ï¼Œé€šå¸¸æœƒæœ‰å…©ç¨®æ–¹å¼</p>
<ul>
<li><code>JSON.parse(JSON.stringify(è¢«æ‹·è²å°è±¡))</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">nestedArr</span><span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">string</span><span class="o">:</span> <span class="s2">&#34;hi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">a</span><span class="p">));</span>
</span></span></code></pre></div><p>é€™å€‹æ–¹æ³•ä¸»è¦æœƒç¢°åˆ°çš„ç¼ºé»æ˜¯ï¼Œ<code>JSON.stringify</code> ç„¡æ³•è™•ç†è¤‡é›œçš„ç‰©ä»¶ï¼Œåªèƒ½è™•ç†ç°¡å–®çš„ç‰©ä»¶ã€é™£åˆ—ä»¥åŠåŸå§‹å‹åˆ¥çš„å€¼</p>
<ol>
<li>å¦‚æœä»–é‡åˆ° <code>Date</code> å‰‡æœƒå°‡ä»–è½‰ç‚ºå­—ä¸²</li>
<li>å¦‚æœé‡åˆ° <code>Set</code>, <code>Map</code>, <code>Regex</code>, <code>File</code>, <code>Error</code>, <code>DOMç¯€é»</code>ï¼ŒæœƒæŠŠå®ƒå€‘è½‰ç‚ºç©ºç‰©ä»¶</li>
<li>é‡åˆ° <code>undefined</code>, <code>function</code> å‹åˆ¥ï¼Œç”šè‡³æœƒç›´æ¥å¿½ç•¥</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">exampleObj</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">dateString</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">  <span class="nx">set</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">  <span class="nx">map</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Map</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&#34;one&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&#34;two&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&#34;three&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="p">]),</span>
</span></span><span class="line"><span class="cl">  <span class="nx">regex</span><span class="o">:</span> <span class="sr">/hello/</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">file</span><span class="o">:</span> <span class="k">new</span> <span class="nx">File</span><span class="p">([</span><span class="s2">&#34;file contents&#34;</span><span class="p">],</span> <span class="s2">&#34;example.txt&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="nx">error</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;example error&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="nx">domNode</span><span class="o">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&#34;div&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="nx">undefinedValue</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">func</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;example function&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">exampleObj</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">{
</span></span></span><span class="line"><span class="cl"><span class="cm">    &#34;dateString&#34;: &#34;2024-02-14T08:48:25.118Z&#34;,
</span></span></span><span class="line"><span class="cl"><span class="cm">    &#34;set&#34;: {},
</span></span></span><span class="line"><span class="cl"><span class="cm">    &#34;map&#34;: {},
</span></span></span><span class="line"><span class="cl"><span class="cm">    &#34;regex&#34;: {},
</span></span></span><span class="line"><span class="cl"><span class="cm">    &#34;file&#34;: {},
</span></span></span><span class="line"><span class="cl"><span class="cm">    &#34;error&#34;: {},
</span></span></span><span class="line"><span class="cl"><span class="cm">    &#34;domNode&#34;: {}
</span></span></span><span class="line"><span class="cl"><span class="cm">}
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span></code></pre></div><ul>
<li><code>_.cloneDeep(è¢«æ‹·è²å°è±¡)</code>
å¯ä»¥è§£æ±º <code>JSON.parse(JSON.stringify(è¢«æ‹·è²å°è±¡))</code> é‡åˆ°çš„å•é¡Œï¼Œä¸Šè¿°å‹åˆ¥å¯ä»¥è¢«æ‹·è²ï¼Œè€Œä¸»è¦è€ƒæ…®çš„é»åœ¨æ–¼è¦ä½¿ç”¨ <code>_.cloneDeep()</code> éœ€è¦é¡å¤– import é€™å€‹ function æˆ–æ˜¯ lodashï¼Œå¯èƒ½å°è‡´æª”æ¡ˆè®Šå¤§ã€åŠ è¼‰æ™‚é–“è®Šé•·ï¼Œä½†å¦‚æœåŸæœ¬åœ¨å°ˆæ¡ˆè£¡é¢å°±æœ‰ä½¿ç”¨ lodashï¼Œ<code>_.cloneDeep()</code> ä¹Ÿæ˜¯ä¸€å€‹æ–¹å¼ã€‚</li>
</ul>
<h3 id="ä½¿ç”¨-structuredclone-ä¾†é€²è¡Œæ·±æ‹·è²">ä½¿ç”¨ structuredClone() ä¾†é€²è¡Œæ·±æ‹·è² <a href="#%e4%bd%bf%e7%94%a8-structuredclone-%e4%be%86%e9%80%b2%e8%a1%8c%e6%b7%b1%e6%8b%b7%e8%b2%9d" class="anchor">ğŸ”—</a></h3><p><code>structuredClone()</code> å¯ä»¥è§£æ±º <code>JSON.parse(JSON.stringify(è¢«æ‹·è²å°è±¡))</code> å¤§éƒ¨åˆ†çš„å•é¡Œï¼Œå¯ä»¥è¢«æ‹·è²çš„å‹åˆ¥åŒ…æ‹¬ <code>Date</code>, <code>Set</code>, <code>Map</code>, <code>Error</code>, <code>RegExp</code>, <code>ArrayBuffer</code>, <code>Blob</code>, <code>File</code>, <code>ImageData</code> ç­‰ï¼Œä¸”ç‚º Web API æä¾›çš„æ–¹æ³•ï¼Œæ‰€ä»¥ä¸ç”¨å†é¡å¤– import å¥—ä»¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼ˆNode.js 17 ä»¥ä¸Šçš„ç‰ˆæœ¬ä¹Ÿæ”¯æ´ structuredClone é€™å€‹æ–¹æ³•äº†ï¼‰ã€‚</p>
<p>è€Œ <code>structuredClone()</code> ä¹Ÿæœ‰ä¸€äº›ä¸èƒ½è¢«æ·±æ‹·è²çš„å‹åˆ¥ï¼š<code>function</code>ã€<code>DOM ç¯€é»</code>ã€<code>åŸå‹éˆ</code></p>
<ul>
<li><strong>æ‹·è² function</strong>: æœƒå ±éŒ¯</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">structuredClone</span><span class="p">({</span> <span class="nx">fn</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{}</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="c1">// VM901:1 Uncaught DOMException: Failed to execute &#39;structuredClone&#39; on &#39;Window&#39;: () =&gt; { } could not be cloned.
</span></span></span></code></pre></div><ul>
<li><strong>æ‹·è² DOM ç¯€é»</strong>ï¼šæœƒå ±éŒ¯</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">structuredClone</span><span class="p">({</span> <span class="nx">el</span><span class="o">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="c1">// VM930:1 Uncaught DOMException: Failed to execute &#39;structuredClone&#39; on &#39;Window&#39;: HTMLBodyElement object could not be cloned.
</span></span></span></code></pre></div><ul>
<li><strong>åŸå‹éˆ</strong>ï¼šå»æ·±æ‹·è²ä¸€å€‹å¯¦ä¾‹çš„æ™‚å€™ï¼Œæ‹·è²å‡ºä¾†çš„çµæœåªæœƒæœ‰è©²å¯¦ä¾‹çš„å±¬æ€§ï¼Œä¸æœƒæ‹·è²åˆ°å¯¦ä¾‹çš„åŸå‹éˆ</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">MyClass</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">constructor</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">getValue</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">obj1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">obj2</span> <span class="o">=</span> <span class="nx">structuredClone</span><span class="p">(</span><span class="nx">obj1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// obj2 ç‚º { value: 10 }
</span></span></span></code></pre></div><h3 id="å¯¦ä½œæ‰‹å¯«æ·±æ‹·è²">å¯¦ä½œæ‰‹å¯«æ·±æ‹·è² <a href="#%e5%af%a6%e4%bd%9c%e6%89%8b%e5%af%ab%e6%b7%b1%e6%8b%b7%e8%b2%9d" class="anchor">ğŸ”—</a></h3><p>å¦‚æœä¸ç”¨ä¸Šè¿°æåˆ°çš„ä¸‰ç¨®æ–¹å¼ä¾†é€²è¡Œæ·±æ‹·è²ï¼Œè€Œé¸æ“‡ç”¨æ‰‹å¯«çš„æ–¹å¼</p>
<ol>
<li>å»ºç«‹ä¸€å€‹ functionï¼Œå‚³å…¥å…©å€‹åƒæ•¸ï¼šobjï¼ˆè¦è¢«æ‹·è²çš„å°è±¡ï¼‰ã€weakMapï¼ˆè¨˜éŒ„æ˜¯å¦å·²ç¶“è™•ç†éè©²å°è±¡ï¼‰</li>
<li>å…ˆæª¢æŸ¥æ˜¯å¦ç‚ºç‰©ä»¶ï¼Œå¦‚æœä¸æ˜¯ç‰©ä»¶å‰‡ä»£è¡¨ç‚ºåŸå§‹å‹åˆ¥ï¼Œå¯ä»¥ç›´æ¥å›å‚³çµæœ</li>
<li>æŸ¥çœ‹ weakMap æ˜¯å¦å·²ç¶“å­˜åœ¨é€™å€‹ obj éµå°ï¼Œå¦‚æœå­˜åœ¨å‰‡ç›´æ¥å›å‚³ weakMap è©²éµå°çš„å€¼</li>
<li>æª¢æŸ¥æ˜¯å¦ç‚º <code>Date</code> æˆ–æ˜¯ <code>RegExp</code> å‹åˆ¥ï¼Œå¦‚æœæ˜¯çš„è©±å‰‡ç”¨ <code>new Date()</code> æˆ– <code>new RegExp()</code> å‰µå»ºæ–°çš„å¯¦ä¾‹</li>
<li>ä»¥ä¸Šéæ¸¡ä¹‹å¾Œï¼Œå‰©ä¸‹å¯èƒ½çš„å‹åˆ¥å‰©ä¸‹ç‰©ä»¶ï¼ˆå¯èƒ½æ˜¯é™£åˆ—æˆ–ç‰©ä»¶ï¼‰</li>
<li>å»ºç«‹ä¸€å€‹æ–°çš„ç‰©ä»¶ï¼šå¦‚æœ obj æ˜¯é™£åˆ—çš„è©±ï¼Œå‰‡å»ºç«‹ç©ºé™£åˆ—ã€å¦‚æœ obj ä¸æ˜¯é™£åˆ—çš„è©±ï¼Œå‰‡å»ºç«‹ç©ºç‰©ä»¶</li>
<li>å°‡é€™å€‹æ–°ç‰©ä»¶å­˜å…¥ weakMap</li>
<li>ä½¿ç”¨ <code>Object.entries</code> é€²è¡Œéè¿´ï¼Œç›´åˆ°æ‰€æœ‰å°è±¡è¢«è™•ç†å®Œ</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">deepClone</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WeakMap</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">obj</span> <span class="o">===</span> <span class="s2">&#34;object&#34;</span><span class="p">)</span> <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">map</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span> <span class="k">return</span> <span class="nx">map</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="k">instanceof</span> <span class="nb">Date</span><span class="p">)</span> <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="k">instanceof</span> <span class="nb">RegExp</span><span class="p">)</span> <span class="k">return</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">?</span> <span class="p">[]</span> <span class="o">:</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">  <span class="nx">map</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kr">const</span> <span class="p">[</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">]</span> <span class="k">of</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">entries</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">result</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">deepClone</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="çµèª">çµèª <a href="#%e7%b5%90%e8%aa%9e" class="anchor">ğŸ”—</a></h3><p>ä»¥ä¸Šæ˜¯æœ€è¿‘çœ‹äº†å¹¾ç¯‡æ–‡ç« å¾Œæ•´ç†çš„æ·±æ·ºæ‹·è²çš„æ–¹å¼ï¼Œä»¥åŠè¿‘æœŸåœ¨é–‹ç™¼ä¸Šå¸¸ç”¨çš„ <code>structuredClone()</code>ï¼Œä¹Ÿå› ç‚ºçœ‹åˆ°å¹¾ç¯‡æ–‡ç« æœ‰æåˆ°å¦‚ä½•æ‰‹å¯«æ·±æ‹·è²ï¼Œæ­é… ChatGPT ä¹ŸæŠŠé€™å€‹ function æ•´ç†åœ¨æ–‡ç« è£¡é¢ã€‚</p>
<p>å¦‚æœæœ‰ä»»ä½•æƒ³æ³•æˆ–éŒ¯èª¤ï¼Œå†éº»ç…©è·Ÿæˆ‘èªªè²ï¼éå¸¸æ„Ÿè¬è§€çœ‹çš„æ‚¨ï½
å¯ä»¥é€éä¿¡ç®±(<a href="mailto:zzuhanlin@gmail.com">zzuhanlin@gmail.com</a>)æˆ– <a href="https://www.linkedin.com/in/zzuhanlin/">linkedin</a> æ‰¾åˆ°æˆ‘</p>
<h3 id="ref-åƒè€ƒæ–‡ç« ">REF åƒè€ƒæ–‡ç«  <a href="#ref-%e5%8f%83%e8%80%83%e6%96%87%e7%ab%a0" class="anchor">ğŸ”—</a></h3><ul>
<li><a href="https://www.builder.io/blog/structured-clone#property-descriptors-setters-and-getters" target="_blank">Deep Cloning Objects in JavaScript, the Modern Way</a>
</li>
<li><a href="https://www.explainthis.io/zh-hant/swe/shallow-copy-and-deep-copy" target="_blank">è«‹å¯¦è¸ JavaScript æ·ºæ‹·è² (shallow copy) å’Œæ·±æ‹·è² (deep copy)</a>
</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/structuredClone" target="_blank">structuredClone() global function</a>
</li>
<li><a href="https://www.codingbeautydev.com/blog/javascript-structuredclone-is-not-defined" target="_blank">How to Fix the "structuredClone is not defined" Error in Node.js</a>
</li>
</ul>

    </div>

    

    <div class="disqus markdown" style="width: 100%;">
        <div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    
    

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'https-www-zzuhann-work';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
</section>

</div>
      <div class="side">
         <div class="side-recent">
    <h2 class="side-title">
        <a href="/posts/">Recent Posts</a>
    </h2>
    <hr />

    <ul>
        
            <li>
                <a href="/posts/ts-unknown-vs-any/">Effective TypeScript: unknown vs any</a>
            </li>
        
            <li>
                <a href="/posts/use-slug-for-dynamic-routes/">ä½¿ç”¨ Next.js çš„ Dynamic Routes ä¾†è™•ç†å¤šå±¤çµæ§‹çš„é é¢</a>
            </li>
        
            <li>
                <a href="/posts/use-flex-to-limit-font-size/">ä½¿ç”¨ flex box ä¾†é˜²æ­¢å­—é«”è¢«å‹•æ…‹èª¿æ•´ï¼Ÿ</a>
            </li>
        
            <li>
                <a href="/posts/strict-false-ignore-null-ts/">tsconfig è¨­å®š strict: false æœƒå¿½ç•¥ null çš„å‹åˆ¥åˆ¤å®š</a>
            </li>
        
            <li>
                <a href="/posts/brain-can-not-multiwork/">è®€æ›¸æ—¥è¨˜ | å¤§è…¦æ²’è¾¦æ³•å¤šå·¥ï¼Œå³ä½¿è¨“ç·´ä¹Ÿä¸€æ¨£ï¼</a>
            </li>
        
    </ul>
</div>
 
        <div class="side-categories">
    <h2>Categories</h2>
    <hr />

    <ul>
        
            <li>
                <a href="/categories/typescript">typescript(4)</a>
            </li>
        
            <li>
                <a href="/categories/%E5%89%8D%E7%AB%AF">å‰ç«¯(2)</a>
            </li>
        
            <li>
                <a href="/categories/%E6%8A%80%E8%A1%93">æŠ€è¡“(7)</a>
            </li>
        
            <li>
                <a href="/categories/%E6%9D%82%E6%8A%80%E6%B5%85%E5%B0%9D">æ‚æŠ€æµ…å°(1)</a>
            </li>
        
            <li>
                <a href="/categories/%E8%A7%80%E7%9C%8B%E7%AD%86%E8%A8%98">è§€çœ‹ç­†è¨˜(1)</a>
            </li>
        
            <li>
                <a href="/categories/%E8%AE%80%E6%9B%B8%E6%97%A5%E8%A8%98">è®€æ›¸æ—¥è¨˜(2)</a>
            </li>
        
    </ul>
</div>
 <div class="side-tags">
    <h2>Tags</h2>
    <hr />

    <ul>
        
            <li>
                <a href="/tags/css">css (1)</a>
            </li>
        
            <li>
                <a href="/tags/css-challenge">css challenge (1)</a>
            </li>
        
            <li>
                <a href="/tags/effective-typescript">effective typescript (4)</a>
            </li>
        
            <li>
                <a href="/tags/hugo">hugo (3)</a>
            </li>
        
            <li>
                <a href="/tags/next.js">next.js (1)</a>
            </li>
        
            <li>
                <a href="/tags/reading-diary">reading diary (2)</a>
            </li>
        
            <li>
                <a href="/tags/typescript">typescript (2)</a>
            </li>
        
            <li>
                <a href="/tags/video-diary">video diary (1)</a>
            </li>
        
    </ul>
</div>

      </div>
    </main>
  </body>
</html>
